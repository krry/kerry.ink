{
  "version": 3,
  "sources": ["../../../src/components/webring/webring.element.ts", "../../../src/components/webring/fetchWebringData.ts"],
  "sourcesContent": ["import { WebringData, WebringLink } from '../../types/webring';\nimport { fetchWebringData, validateWebringData } from './fetchWebringData';\n\n/**\n * Web Component wrapper for the webring widget\n * Usage: <webring-widget data-source=\"url\" mode=\"compact\" theme=\"auto\"></webring-widget>\n */\nclass WebringElement extends HTMLElement {\n  private shadow: ShadowRoot;\n  private data: WebringData | null = null;\n  private loading = false;\n  private expanded = false;\n\n  constructor() {\n    super();\n    this.shadow = this.attachShadow({ mode: 'open' });\n  }\n\n  /**\n   * Observed attributes that trigger attributeChangedCallback\n   */\n  static get observedAttributes(): string[] {\n    return ['data-source', 'mode', 'theme'];\n  }\n\n  /**\n   * Lifecycle: element is inserted into the DOM\n   */\n  async connectedCallback(): Promise<void> {\n    this.render();\n    await this.loadData();\n    \n    // Listen for system theme changes when theme=\"auto\"\n    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\n    mediaQuery.addEventListener('change', () => {\n      if (this.getAttribute('theme') === 'auto') {\n        this.render();\n      }\n    });\n  }\n\n  /**\n   * Lifecycle: an observed attribute has changed\n   */\n  async attributeChangedCallback(name: string, _oldValue: string, _newValue: string): Promise<void> {\n    if (name === 'data-source') {\n      this.data = null;\n      await this.loadData();\n      this.render();\n    } else {\n      this.render();\n    }\n  }\n\n  /**\n   * Load data from data-source attribute\n   */\n  private async loadData(): Promise<void> {\n    if (this.loading) return;\n\n    const source = this.getAttribute('data-source');\n    if (!source) {\n      this.renderError('No data-source attribute provided');\n      return;\n    }\n\n    this.loading = true;\n    this.renderLoading();\n\n    try {\n      this.data = await fetchWebringData(source);\n      if (!validateWebringData(this.data)) {\n        this.renderError('Invalid webring data format');\n        return;\n      }\n      this.render();\n    } catch (error) {\n      const message = error instanceof Error ? error.message : 'Failed to load webring data';\n      this.renderError(message);\n    } finally {\n      this.loading = false;\n    }\n  }\n\n  /**\n   * Resolve theme (auto -> light/dark based on system preference)\n   */\n  private resolveTheme(): string {\n    const themeAttr = this.getAttribute('theme') || 'auto';\n    if (themeAttr === 'auto') {\n      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\n    }\n    return themeAttr;\n  }\n\n  /**\n   * Main render method\n   */\n  private render(): void {\n    const mode = this.getAttribute('mode') || 'compact';\n    const theme = this.resolveTheme();\n\n    if (!this.data) {\n      return;\n    }\n\n    const html = `\n      <style>\n        :host {\n          /* Light mode defaults (glass effect) */\n          --glass-bg: rgba(255, 255, 255, 0.5);\n          --glass-border: rgba(255, 255, 255, 0.62);\n          --text: rgba(0, 0, 0, 0.82);\n          --muted: rgba(0, 0, 0, 0.62);\n          --shadow: rgba(0, 0, 0, 0.18);\n          --blur: 18px;\n        }\n\n        .webring {\n          color: var(--text);\n          background: var(--glass-bg);\n          border: 1px solid var(--glass-border);\n          backdrop-filter: blur(var(--blur));\n          -webkit-backdrop-filter: blur(var(--blur));\n          box-shadow: 0 12px 40px var(--shadow);\n          border-radius: 12px;\n          padding: 1rem;\n          font-family: system-ui, -apple-system, sans-serif;\n          cursor: pointer;\n          transition: all 300ms cubic-bezier(0.4, 0, 0.2, 1);\n          overflow: hidden;\n        }\n\n        .webring--collapsed {\n          padding: 0.75rem;\n          max-height: 2.25rem;\n        }\n\n        .webring--expanded {\n          max-height: 500px;\n        }\n\n        .webring--dark {\n          --glass-bg: rgba(255, 255, 255, 0.14);\n          --glass-border: rgba(255, 255, 255, 0.28);\n          --text: rgba(255, 255, 255, 0.92);\n          --muted: rgba(255, 255, 255, 0.7);\n          --shadow: rgba(0, 0, 0, 0.35);\n        }\n\n        .webring__title {\n          margin: 0;\n          font-size: 1.5em;\n          font-weight: 600;\n          text-align: center;\n          transition: margin 300ms ease;\n        }\n\n        .webring--expanded .webring__title {\n          margin-bottom: 0.5rem;\n        }\n\n        .webring__links {\n          list-style: none;\n          padding: 0;\n          margin: 0;\n          opacity: 0;\n          transform: translateY(-10px);\n          transition: opacity 300ms ease, transform 300ms ease;\n          pointer-events: none;\n        }\n\n        .webring--expanded .webring__links {\n          opacity: 1;\n          transform: translateY(0);\n          pointer-events: auto;\n        }\n\n        .webring__link-item {\n          margin: 0.5rem 0;\n        }\n\n        .webring__link {\n          color: var(--text);\n          text-decoration: none;\n          opacity: 0.85;\n          transition: opacity 120ms ease;\n        }\n\n        .webring__link:hover {\n          opacity: 1;\n        }\n\n        .webring__description {\n          margin: 0.25rem 0 0 0;\n          font-size: 0.9em;\n          color: var(--muted);\n        }\n      </style>\n\n      <div class=\"webring webring--${mode}${theme === 'dark' ? ' webring--dark' : ''}${this.expanded ? ' webring--expanded' : ' webring--collapsed'}\">\n        <h3 class=\"webring__title\">\uD83E\uDEE0\u2712\uFE0F</h3>\n        <ul class=\"webring__links\">\n          ${this.data.links\n            .map(\n              (link) => `\n            <li class=\"webring__link-item\">\n              <a href=\"${link.url}\" class=\"webring__link\" title=\"${link.description || link.name}\">\n                ${link.name}\n              </a>\n              ${\n                link.description && mode === 'full'\n                  ? `<p class=\"webring__description\">${link.description}</p>`\n                  : ''\n              }\n            </li>\n          `\n            )\n            .join('')}\n        </ul>\n      </div>\n    `;\n\n    this.shadow.innerHTML = html;\n    this.attachEventListeners();\n  }\n\n  /**\n   * Attach event listeners for expand/collapse\n   */\n  private attachEventListeners(): void {\n    const webring = this.shadow.querySelector('.webring');\n    if (!webring) return;\n\n    // Click to toggle\n    webring.addEventListener('click', () => {\n      this.expanded = !this.expanded;\n      this.render();\n    });\n\n    // Hover to expand (but not collapse)\n    webring.addEventListener('mouseenter', () => {\n      if (!this.expanded) {\n        this.expanded = true;\n        this.render();\n      }\n    });\n\n    // Optional: collapse on mouse leave (comment out if you want click-to-collapse only)\n    // webring.addEventListener('mouseleave', () => {\n    //   if (this.expanded) {\n    //     this.expanded = false;\n    //     this.render();\n    //   }\n    // });\n  }\n\n  /**\n   * Render loading state\n   */\n  private renderLoading(): void {\n    this.shadow.innerHTML = '<div style=\"padding: 1rem; text-align: center;\">Loading webring...</div>';\n  }\n\n  /**\n   * Render error state\n   */\n  private renderError(message: string): void {\n    this.shadow.innerHTML = `<div style=\"padding: 1rem; color: #c33; background: #fdd; border: 1px solid #fbb; border-radius: 4px;\">Error: ${message}</div>`;\n  }\n}\n\n// Register the custom element\nif (!customElements.get('webring-widget')) {\n  customElements.define('webring-widget', WebringElement);\n}\n\nexport default WebringElement;\n", "import { WebringData } from '../../types/webring';\n\n/**\n * Fetch webring data from a URL or return inline data\n * @param source - URL string or inline WebringData object\n * @returns Promise<WebringData>\n */\nexport async function fetchWebringData(source: string | WebringData): Promise<WebringData> {\n  // If source is already an object, return it\n  if (typeof source === 'object' && source !== null) {\n    return source;\n  }\n\n  // If source is a URL string, fetch it\n  if (typeof source === 'string') {\n    const response = await fetch(source);\n    if (!response.ok) {\n      throw new Error(`Failed to fetch webring data from ${source}: ${response.statusText}`);\n    }\n    return response.json() as Promise<WebringData>;\n  }\n\n  throw new Error('Invalid data source: must be a URL string or WebringData object');\n}\n\n/**\n * Validate webring data structure\n * @param data - WebringData to validate\n * @returns boolean\n */\nexport function validateWebringData(data: WebringData): boolean {\n  return (\n    typeof data === 'object' &&\n    typeof data.version === 'string' &&\n    Array.isArray(data.links) &&\n    data.links.every(\n      (link) => typeof link.name === 'string' && typeof link.url === 'string'\n    )\n  );\n}\n"],
  "mappings": "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",
  "names": ["webring_element_exports", "__export", "webring_element_default", "fetchWebringData", "source", "response", "validateWebringData", "data", "link", "WebringElement", "__publicField", "name", "_oldValue", "_newValue", "source", "fetchWebringData", "validateWebringData", "error", "message", "themeAttr", "mode", "theme", "html", "link", "webring", "webring_element_default"]
}
